# ğŸ›’Loja Virtual Service - MicrosserviÃ§o

## ğŸ“„ DescriÃ§Ã£o

Este microsserviÃ§o Ã© responsÃ¡vel pela gestÃ£o das compras de produtos na loja virtual. Ele integra-se com outros microsserviÃ§os, como o serviÃ§o de produtos, serviÃ§o de pagamento e serviÃ§o de usuÃ¡rio, para realizar uma compra e verificar o pagamento. O processo Ã© baseado no padrÃ£o BFF (Backend for Frontend), onde este microsserviÃ§o serve como uma camada intermediÃ¡ria entre o frontend e os outros serviÃ§os.

## ğŸ”§ Funcionalidades
* ğŸ” Busca os dados de usuÃ¡rio com base no e-mail fornecido.
* ğŸ›ï¸ Recupera os detalhes do produto pelo nome.
* ğŸ’³ Verifica o pagamento utilizando as informaÃ§Ãµes do usuÃ¡rio e produto.
* âœ… Retorna a resposta de aprovaÃ§Ã£o ou negaÃ§Ã£o da compra.

## ğŸ› ï¸ Estrutura de CÃ³digo
Classe Principal: LojaVirtualService
MÃ©todos:

* realizaCompraProdutos(CompraRequestDTO compraRequestDTO): Principal mÃ©todo que processa a compra de um produto. Ele busca os dados do usuÃ¡rio e do produto, verifica o pagamento e retorna o status da compra.

* buscaDadosUsuario(String email): MÃ©todo privado que consulta o serviÃ§o de usuÃ¡rios para obter os dados do usuÃ¡rio.

* buscaDadosProdutos(String nome): MÃ©todo privado que consulta o serviÃ§o de produtos para obter as informaÃ§Ãµes do produto.

* verificaPagamento(UsuarioResponseDTO usuario, CompraRequestDTO compraRequestDTO, ProductsDTO produto): MÃ©todo privado que valida o pagamento utilizando o serviÃ§o de pagamento.

## ğŸ“¦ DependÃªncias
Este microsserviÃ§o depende de trÃªs outros serviÃ§os:

* ProdutosService ğŸ›ï¸: Usado para buscar detalhes dos produtos.
* PagamentoService ğŸ’³: Realiza a verificaÃ§Ã£o de pagamento.
* UsuarioService ğŸ‘¤: ResponsÃ¡vel por buscar os dados dos usuÃ¡rios.
* LojaVirtualConverter ğŸ”„: Um conversor para preparar os dados antes de enviar ao serviÃ§o de pagamento.

## ğŸ“‘ API com Swagger
O microsserviÃ§o expÃµe suas rotas atravÃ©s de uma interface de documentaÃ§Ã£o Swagger. VocÃª pode acessar o Swagger UI para testar as APIs diretamente no navegador atravÃ©s do seguinte endereÃ§o:

Swagger UI - Loja Virtual API

## ğŸ“œ Rotas DisponÃ­veis

1. Buscar todos os produtos

* MÃ©todo: GET
* Rota: /loja-virtual/produtos
* DescriÃ§Ã£o: Retorna a lista de todos os produtos disponÃ­veis.
* Respostas:

  * 200 OK: Busca realizada com sucesso.
  * 500 Internal Server Error: Erro ao realizar a busca.
2. Buscar produto por nome

* MÃ©todo: GET
* Rota: /loja-virtual/produtos/{nome}
* DescriÃ§Ã£o: Retorna os detalhes de um produto especÃ­fico pelo nome.
* Respostas:

   * 200 OK: Produto encontrado com sucesso.
   * 500 Internal Server Error: Erro ao realizar a busca.
3. Cadastrar UsuÃ¡rio

* MÃ©todo: POST
* Rota: /loja-virtual/usuario
* DescriÃ§Ã£o: Cadastra um novo usuÃ¡rio.
* Respostas:

   * 200 OK: Cadastro realizado com sucesso.
   * 500 Internal Server Error: Erro ao cadastrar o usuÃ¡rio.
4. Deletar UsuÃ¡rio por e-mail

* MÃ©todo: DELETE
* Rota: /loja-virtual/usuario/{email}
* DescriÃ§Ã£o: Deleta um usuÃ¡rio especÃ­fico pelo e-mail.
* Respostas:
   * 200 OK: UsuÃ¡rio deletado com sucesso.
   * 500 Internal Server Error: Erro ao deletar o usuÃ¡rio.
5. Realizar compra de produto

* MÃ©todo: POST
* Rota: /loja-virtual/compra
* DescriÃ§Ã£o: Processa a compra de um produto e verifica o pagamento.
* Respostas:
   * 200 OK: Compra realizada com sucesso.
   * 500 Internal Server Error: Erro ao realizar a compra.

## ğŸ“ RequisiÃ§Ã£o de Compra
Exemplo de CompraRequestDTO:
```
{
  "produto": "Mens Cotton Jacket",
  "email": "email@email",
  "numeroCartao": "12345668080",
  "mes": "01",
  "ano": "2023",
  "cvv": "54"
}
```

## ğŸš€ Fluxo de Processo:
1. O microsserviÃ§o recebe uma requisiÃ§Ã£o de compra.

2. Busca os dados do usuÃ¡rio baseado no e-mail fornecido.

3. Busca os detalhes do produto solicitado.

4. Valida o pagamento atravÃ©s do serviÃ§o de pagamento.

5. Retorna uma mensagem de aprovaÃ§Ã£o ou negaÃ§Ã£o do pagamento.

## ğŸ”„ Retornos
* âœ… "Pagamento aprovado": Quando o pagamento Ã© aprovado pelo serviÃ§o de pagamento.
* âŒ "Pagamento Negado": Quando o pagamento nÃ£o Ã© autorizado.
